<project name="spatialite4java" default="all">
	<target name="sources">
		<mkdir dir="build/swig"/>
		<mkdir dir="build/java"/>
		<copy todir="build/java">
			<fileset dir="../java"/>
		</copy>
		
		<exec executable="swig" failonerror="true">
			<arg value="-java"/>
			<arg value="-package"/>
			<arg value="com.almworks.sqlite4java"/>
			<arg value="-outdir"/>
			<arg value="build/java/com/almworks/sqlite4java"/>
			<arg value="-o"/>
			<arg value="build/swig/sqlite_wrap.c"/>
			<arg value="../swig/sqlite.i"/>
		</exec>
	</target>

	<target name="compile" depends="sources">
		<mkdir dir="build/classes"/>
		<javac srcdir="build/java" destdir="build/classes" debug="on" source="1.5" target="1.5" includeantruntime="false">
		</javac>
	</target>
	
	<target name="headers" depends="compile">
		<!--
		<javah class="mapnik.Parameters,mapnik.Mapnik,mapnik.Map,mapnik.Layer,mapnik.FeatureTypeStyle,mapnik.Datasource,mapnik.DatasourceCache,mapnik.Projection,mapnik.Query,mapnik.FeatureSet,mapnik.Geometry" outputfile="csrc/mapnikjni.h" classpath="build/classes"/>
		-->
	</target>
	
	<target name="jar" depends="compile">
		<mkdir dir="build/dist"/>
		<jar jarfile="build/dist/spatialite4java.jar" basedir="build/classes"/>
	</target>
	
	<target name="clean">
		<delete dir="build"/>
	</target>
	
	<target name="native-init">
		<condition property="platform.osx">
			<os family="mac"/>
		</condition>
	</target>
	<target name="native-osx" if="platform.osx">
		<mkdir dir="build/dist"/>
		<exec executable="make" failonerror="true">
			<arg value="-f"/>
			<arg value="Makefile.osx"/>
		</exec>
	</target>
	<target name="native" depends="native-init,native-osx"/>
	
	<target name="all" depends="jar,native"/>
	<target name="dist" depends="clean,all"/>	
</project>

